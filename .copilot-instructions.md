# Copilot Instructions for Todo-POS-Printer Web Service

## Project Overview

**Note:** This is a mobile-first app with nearly no desktop usage. All UI and features should be optimized for phone screens and touch interactions.

This is a lightweight web service designed to interface between a web-based todo management system and an Epson POS printer. The system serves as a bridge for printing todo tasks and managing printer status.

## System Architecture

### Core Components

- **Express.js TypeScript Server**: REST API backend
- **Mobile-First Web Interface**: Todo management UI optimized for phones
- **Epson POS Printer Integration**: Automated printing workflow

### Data Flow

1. Users add todos via web interface (mobile-optimized)
2. POS printer polls `/todos` endpoint every 5 seconds
3. Printer processes and prints all available todos
4. After successful print, printer sends DELETE requests to remove printed todos
5. Printer sends status updates every 5 seconds to `/printer-status`

## API Specifications

### Todo Management

- `GET /todos` - Returns all pending todos (printer polling endpoint)
- `POST /todos` - Add new todo with fields: `{todo, deadline, assignee}`
- `DELETE /todos/:id` - Remove specific todo (called by printer after successful print)

### Printer Status

- `POST /printer-status` - Receive printer status updates
- `GET /printer-status` - Get current printer status
- Status types: paper levels, jams, connectivity, errors

### Web Interface

- `GET /` - Mobile-optimized todo management interface

## Development Principles

### Code Style

- **Form follows function**: Prioritize functionality over aesthetics
- **Pragmatic approach**: Choose simple, reliable solutions
- **Precise implementation**: Minimal, focused code without bloat
- **TypeScript strict mode**: Full type safety
- **Error handling**: Robust error states and user feedback

### Architecture Decisions

- **In-memory storage**: Simple, fast, suitable for POS environment
- **RESTful API**: Standard HTTP methods for printer integration
- **Mobile-first UI**: 90% of usage will be on mobile devices
- **Vanilla JavaScript**: No complex frameworks, keep it lightweight

## Technical Context

### Epson POS Printer Integration

- Printer is the primary consumer of the todo API
- 5-second polling interval for todos and status updates
- Automatic cleanup after successful prints
- Status monitoring for operational awareness (paper, jams, errors)

### Mobile Interface Requirements

- Touch-friendly UI elements (44px+ touch targets)
- Single-column layout optimized for phone screens
- Fast loading and minimal data usage
- Emoji-based iconography for visual clarity
- Immediate feedback for user actions

## Development Guidelines

### When Making Changes

1. **Maintain API contracts**: Printer depends on exact endpoint behavior
2. **Preserve mobile optimization**: Always test on phone-sized screens
3. **Keep it simple**: Avoid over-engineering solutions
4. **Handle edge cases**: Network failures, printer errors, validation
5. **Maintain type safety**: Use TypeScript interfaces for all data structures

### Code Organization

- Server logic in `/src/server.ts`
- Client interface in `/public/index.html`
- Type definitions inline with usage
- Minimal dependencies, prefer built-in solutions

### Testing Approach

- Focus on API endpoint reliability
- Test mobile interface responsiveness
- Validate printer polling behavior
- Error state handling

## Constraints & Limitations

- No database dependency (in-memory storage)
- No authentication (internal POS system)
- No complex state management
- Optimized for single-location/single-printer setup

## Success Metrics

- Reliable todo printing workflow
- Zero data loss during printer operations
- Fast, responsive mobile interface
- Clear printer status visibility
- Minimal maintenance overhead

## Common Tasks

- Adding new todo fields (update types, API, UI)
- Modifying printer status handling
- UI responsiveness improvements
- API error handling enhancements
- Performance optimizations for high-frequency polling
